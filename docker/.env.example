# SQL Server to PostgreSQL CDC Pipeline - Environment Configuration
# Copy this file to .env and update with your values
# NEVER commit the .env file to version control

# =============================================================================
# SQL Server Configuration (Source Database)
# =============================================================================
# SQL Server must have CDC enabled: EXEC sys.sp_cdc_enable_db
SQLSERVER_HOST=sqlserver
SQLSERVER_PORT=1433
SQLSERVER_DATABASE=warehouse_source
SQLSERVER_USER=sa
SQLSERVER_PASSWORD=YourStrong!Passw0rd
SQLSERVER_AGENT_ENABLED=true

# =============================================================================
# PostgreSQL Configuration (Target Database)
# =============================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=warehouse_target
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres_secure_password

# =============================================================================
# Kafka Configuration
# =============================================================================
KAFKA_BROKER=kafka:9092
KAFKA_INTERNAL_LISTENERS=PLAINTEXT://0.0.0.0:9092
KAFKA_EXTERNAL_LISTENERS=PLAINTEXT://localhost:29092
KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181

# Topic configuration
KAFKA_AUTO_CREATE_TOPICS_ENABLE=true
KAFKA_NUM_PARTITIONS=3
KAFKA_DEFAULT_REPLICATION_FACTOR=1  # Set to 3 in production

# =============================================================================
# Schema Registry Configuration
# =============================================================================
SCHEMA_REGISTRY_HOST=schema-registry
SCHEMA_REGISTRY_PORT=8081
SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS=kafka:9092

# =============================================================================
# Kafka Connect Configuration
# =============================================================================
CONNECT_BOOTSTRAP_SERVERS=kafka:9092
CONNECT_REST_PORT=8083
CONNECT_GROUP_ID=cdc-connect-cluster
CONNECT_CONFIG_STORAGE_TOPIC=connect-configs
CONNECT_OFFSET_STORAGE_TOPIC=connect-offsets
CONNECT_STATUS_STORAGE_TOPIC=connect-status
CONNECT_KEY_CONVERTER=io.confluent.connect.avro.AvroConverter
CONNECT_VALUE_CONVERTER=io.confluent.connect.avro.AvroConverter
CONNECT_KEY_CONVERTER_SCHEMA_REGISTRY_URL=http://schema-registry:8081
CONNECT_VALUE_CONVERTER_SCHEMA_REGISTRY_URL=http://schema-registry:8081

# Connector plugins
CONNECT_PLUGIN_PATH=/usr/share/java,/usr/share/confluent-hub-components

# Task configuration
CONNECT_TASKS_MAX=3

# =============================================================================
# HashiCorp Vault Configuration
# =============================================================================
VAULT_ADDR=http://vault:8200
VAULT_DEV_ROOT_TOKEN_ID=dev-root-token
VAULT_DEV_LISTEN_ADDRESS=0.0.0.0:8200
VAULT_API_ADDR=http://vault:8200

# Vault secrets engine
VAULT_SECRETS_ENGINE=secret
VAULT_SECRETS_PATH=database

# =============================================================================
# Prometheus Configuration
# =============================================================================
PROMETHEUS_PORT=9090
PROMETHEUS_SCRAPE_INTERVAL=15s
PROMETHEUS_EVALUATION_INTERVAL=15s

# =============================================================================
# Grafana Configuration
# =============================================================================
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin_secure_password
GRAFANA_ALLOW_SIGNUP=false
GRAFANA_DISABLE_GRAVATAR=true

# =============================================================================
# Jaeger Configuration
# =============================================================================
JAEGER_AGENT_PORT=6831
JAEGER_COLLECTOR_PORT=14268
JAEGER_QUERY_PORT=16686
JAEGER_SAMPLING_RATE=1.0  # 1.0 = 100% sampling for dev, reduce in production

# =============================================================================
# Application Configuration
# =============================================================================
# Reconciliation settings
RECONCILIATION_SCHEDULE_CRON=0 2 * * *  # Daily at 2 AM
RECONCILIATION_BATCH_SIZE=10000
RECONCILIATION_PARALLEL_TABLES=5

# Monitoring thresholds
ALERT_REPLICATION_LAG_SECONDS=300  # 5 minutes
ALERT_ERROR_RATE_PERCENT=5  # 5% error rate threshold
ALERT_CONNECTOR_DOWN_MINUTES=5

# Resource limits
MAX_MEMORY_GB=4
MAX_CPU_CORES=2

# =============================================================================
# Development/Test Settings
# =============================================================================
# Set to 'true' to enable debug logging
DEBUG_MODE=false
LOG_LEVEL=INFO

# Test data settings
TEST_SAMPLE_SIZE=10000
TEST_BULK_INSERT_SIZE=10000
